# Swift Macros - 宏之角色：宏的功能标识



Swift 宏不是一刀切的，它有明确的“职责划分”，这些职责被称为 **宏角色（Macro Role）**。

Swift 使用 **独立宏（Freestanding）** 和 **绑定宏（Attached）** 来声明宏的角色。

* **独立宏**：使用`@freestanding(xxx)` 表示，可以单独存在，不依附任何已有代码。通常用于生成表达式或声明。

* **绑定宏**：使用 `@attached(XXX)` 表示，必须附着在已有代码元素上，例如类型、函数、属性等，用于扩展或修改已有结构。

不同的宏角色，需要实现不同的协议来完成展开逻辑，用来告诉编译器：“我这个宏能做什么”。因此： 宏角色也被称为 **“Swift 宏的功能标识”**。

| 宏角色                       | 宏描述             | 对应协议名             | 宏用途示例                         |
| ---------------------------- | ------------------ | ---------------------- | ---------------------------------- |
| `@freestanding(expression)`  | 表达式独立宏       | `ExpressionMacro`      | 替换表达式，生成新的表达式         |
| `@freestanding(declaration)` | 声明式独立宏       | `DeclarationMacro`     | 插入变量、函数、类型等声明         |
| `@attached(member)`          | 成员绑定宏         | `MemberMacro`          | 向类型内部插入成员（变量、函数等） |
| `@attached(peer)`            | 对等绑定宏         | `PeerMacro`            | 插入与目标声明并列的新声明         |
| `@attached(accessor)`        | 访问器绑定宏       | `AccessorMacro`        | 插入属性访问器（get、set等）       |
| `@attached(extension)`       | 扩展绑定宏         | `ExtensionMacro`       | 插入扩展声明（`extension`）        |
| `@attached(memberAttribute)` | 成员属性绑定宏     | `MemberAttributeMacro` | 修改成员属性上的注解或特性         |
| `@attached(body)`            | 替换声明体的绑定宏 | `BodyMacro`            | 替换函数、方法或计算属性的函数体   |

> 独立宏： 使用 `#`  调用。
>
> 绑定宏：使用 `@`  调用。
